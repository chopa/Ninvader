<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>
var target = null;
function setup(){
  target = makeTarget(50,10);
}

var gunX = 250;
function clickLeft(){
  var c =document.getElementById("gun");
  if (c != null){
    gunX = gunX - 50;
    c.style.left = gunX;
  }
}

function clickRight(){
  var c =document.getElementById("gun");
  if (c != null){
    gunX = gunX + 50;
    c.style.left = gunX;
  }
}

function keyDown(e){
  // alert("code:" +e.keyCode);
  if(e.keyCode ==32){
    clickFire();
  }
  if(e.keyCode ==37){
    clickLeft();
  }
  if(e.keyCode ==39){
    clickRight();
  }
}

document.addEventListener("keydown",keyDown);

function makeTarget(x,y){
  var e = document.createElement("img");
  e.src = "target.png";
  e.style.width ="50px";
  e.style.position ="absolute";
  e.style.top = y;
  e.style.left = x;
  document.body.appendChild(e);
  return e;
}

function makeBullet(){
  var e = document.createElement("img");
  e.src ="bullet.png";
  e.style.width = "15px";
  e.style.position = "absolute";
  e.style.top = 320
  e.style.left = gunX;
  document.body.appendChild(e);
  return e;
}

function makeBomb(){
  var e = document.createElement("img");
  var t = target;
  var x = parseInt(t.style.left);
  var y = parseInt(t.style.top);
  e.src ="bomb.png";
  e.style.width = "25px";
  e.style.position = "absolute";
  e.style.top = y;
  e.style.left = x;
  document.body.appendChild(e);
  return e;
}

var bullet = null; //初期値はnull(空)
var bomb = null;

function clickFire(){
  if (bullet != null) {
    document.body.removeChild(bullet);
  }
  bullet = makeBullet();
}

var timer;

function move(){

  var t = target;
  var x = parseInt(t.style.left);
  var y = parseInt(t.style.top);
  t.style.left = x + 50;
  if (x > 600){
    t.style.left = 50;
    t.style.top = y + 30;
  }
  if (bullet !=null){
    var bx = parseInt(bullet.style.left);
    var by = parseInt(bullet.style.top);
    bullet.style.top = by - 10;
    if (parseInt(bullet.style.top)<0){
      document.body.removeChild(bullet);
      bullet = null;
    }
    if (bx <= x && x <= bx + 100 && by <= y && y <= by + 80 ){
      document.body.removeChild(t);
      clearInterval(timer);
    }
  }

  if (bomb !=null){
    var bx = parseInt(bomb.style.left);
    var by = parseInt(bomb.style.top);
    bomb.style.top = by + 15;
    if (parseInt(bomb.style.top) > 480){
      document.body.removeChild(bomb);
      bomb = null;
    }
    var gt = document.getElementById("gun");
    var gx = parseInt(gt.style.left);
    var gy = parseInt(gt.style.top);

    if (bx <= gx && gx <= bx + 75 && by <= gy && gy <= by + 30 ){
      document.body.removeChild(gt);
      clearInterval(timer);
    }
  }
  if (y > 350){
      clearInterval(timer);
  }

  var r = Math.floor(Math.random() * 10);
  if (r == 0 && bomb == null){
    bomb = makeBomb();
  }
}



</script>
</head>
<body bgcolor="C1FBC8" onload="setup();timer = setInterval('move()',100)">
<img src ="gun.png" width =60px
style="position:absolute;left:300px;top:350px;"id = "gun">
</img>

<img src ="left.png" width =50px
style="position:absolute;left:50px;top:450px;"id = "left" onclick = "clickLeft();">
</img>

<img src="right.png" width=50px
 style ="position:absolute;left:550px;top:450px;"id = "Right" onclick = "clickRight();">
</img>

<img src="fire.png" width=100px
style = "position:absolute;Left:300px;top:530px;"id = "fire" onclick="clickFire();
">
</img>
</body>
</html>
